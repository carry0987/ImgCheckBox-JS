!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ImgCheckBox=t()}(this,(function(){"use strict";function e(e){throw new Error(e)}var t=Object.freeze({__proto__:null,reportError:function(...e){console.error(...e)},throwError:e});function n(e,t,n){if("string"!=typeof e)return e;let o=document;return null===t&&n?o=n:t&&t instanceof Node&&"querySelector"in t?o=t:n&&n instanceof Node&&"querySelector"in n&&(o=n),"all"===t?o.querySelectorAll(e):o.querySelector(e)}function o(e,t={},n=""){let o=document.createElement(e);for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&("textContent"===e||"innerText"===e?o.textContent=t[e]:o.setAttribute(e,t[e]));return n&&(o.textContent=n),o}var i=Object.freeze({__proto__:null,addClass:function(e,t){return e.classList.add(t),e},createElem:o,getElem:n,hasClass:function(e,t){return e.classList.contains(t)},insertAfter:function(t,n){if("string"==typeof n){let t=o("div");t.innerHTML=n,(n=t.firstChild)||e("The new node (string) provided did not produce a valid DOM element.")}t.parentNode.insertBefore(n,t.nextSibling)},insertBefore:function(t,n){if("string"==typeof n){let t=o("div");t.innerHTML=n,(n=t.firstChild)||e("The new node (string) provided did not produce a valid DOM element.")}t.parentNode.insertBefore(n,t)},removeClass:function(e,t){return e.classList.remove(t),e},toggleClass:function(e,t){return e.classList.toggle(t),e}});let s="utils-style";const r={from:".utils",to:".utils-"};function l(e,...t){if(!t.length)return e;const n=t.shift();if(n)for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t],s=t;"object"!=typeof(o=i)||null===o||Array.isArray(o)?e[s]=i:(e[s]&&"object"==typeof e[s]||(e[s]={}),l(e[s],i))}var o;return l(e,...t)}function c(e){s=e}function a(e,t){r.from=e,r.to=t}function d(e,t=null){t=f(t)?"":t;let n=o("style");n.id=s+t,n.textContent="",document.head.append(n);let i=n.sheet;for(let n in e)e.hasOwnProperty(n)&&g(i,n,h(e[n]),t)}function h(e){let t="";for(let[n,o]of Object.entries(e))n=n.replace(/([A-Z])/g,(e=>`-${e[0].toLowerCase()}`)),t+=`${n}:${o};`;return t}function g(e,t,n,o=null){o=f(o)?"":o;let i=t.replace(r.from,r.to+o);e.insertRule(i+"{"+n+"}",0)}function m(e=null){e=f(e)?"":e;let t=n("#"+s+e);t&&t.parentNode.removeChild(t)}function f(e){return"number"!=typeof e&&(!e||"string"==typeof e&&0===e.length)}class u{static throwError=t.throwError;static deepMerge=l;static setStylesheetId=c;static setReplaceRule=a;static injectStylesheet=d;static removeStylesheet=m;static getElem=i.getElem;static changeSelection(e,t,n,o,i,s,r){const{CHECK_MARK:l,CHK_DESELECT:c,CHK_TOGGLE:a,CHK_SELECT:d}=r,h=e.classList.contains(l);o&&t!==c?(s.forEach((t=>t!==e&&t.classList.remove(l))),i?e.classList.toggle(l):e.classList.add(l)):t===c&&e.classList.remove(l)||t===a&&e.classList.toggle(l)||t===d&&e.classList.add(l);const g=e.classList.contains(l);if(h!==g){const t=new CustomEvent("change",{detail:{isSelected:g}});e.dispatchEvent(t)}return n&&u.updateFormValues(o?s:e,l),g}static updateFormValues(e,t){(e instanceof Array?e:[e]).forEach((e=>{if(!("dataset"in e))return;const n=u.getElem("."+e.dataset.hiddenElementId,"all");n&&n.forEach((n=>{if(n instanceof HTMLElement&&"input"===n.tagName.toLowerCase()){const o=n;o.checked=e.classList.contains(t),o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked")}}))}))}static buildStyles(e,t,n,o){let i={};const s=(e,n,o=!1)=>{let s=e.startsWith("::")?"":" ";e||(s="."+t),i[`span.imgCheckbox${o?"."+t:""}${s}${e}`]=n};if("object"==typeof n&&"object"==typeof o)s(e,n),s(e,o,!0);else for(let[e,t]of Object.entries(n))s(e,t,!!e);return i}}u.setStylesheetId("imgCheckbox-style"),u.setReplaceRule(".imgCheckbox",".imgCheckbox");const p="imgChked",C={"top-left":{top:"0.5%",left:"0.5%"},top:{top:"0.5%",left:0,right:0,margin:"auto"},"top-right":{top:"0.5%",right:"0.5%"},left:{left:"0.5%",bottom:0,top:0,margin:"auto"},right:{right:"0.5%",bottom:0,top:0,margin:"auto"},"bottom-left":{bottom:"0.5%",left:"0.5%"},bottom:{bottom:"0.5%",left:0,right:0,margin:"auto"},"bottom-right":{bottom:"0.5%",right:"0.5%"},center:{top:"0.5%",bottom:"0.5%",left:"0.5%",right:"0.5%",margin:"auto"}},b={checkMarkImage:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtMzQ2LjM4NCkiPjxwYXRoIGZpbGw9IiMxZWM4MWUiIGZpbGwtb3BhY2l0eT0iLjgiIGQ9Ik0zMiAzNDYuNGEzMiAzMiAwIDAgMC0zMiAzMiAzMiAzMiAwIDAgMCAzMiAzMiAzMiAzMiAwIDAgMCAzMi0zMiAzMiAzMiAwIDAgMC0zMi0zMnptMjEuMyAxMC4zbC0yNC41IDQxTDkuNSAzNzVsMTcuNyA5LjYgMjYtMjh6Ii8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTkuNSAzNzUuMmwxOS4zIDIyLjQgMjQuNS00MS0yNiAyOC4yeiIvPjwvZz48L3N2Zz4=",enableShiftClick:!0,graySelected:!0,scaleSelected:!0,fixedImageSize:!1,checkMark:"imgChked",checkMarkSize:"30px",checkMarkPosition:"top-left",scaleCheckMark:!0,fadeCheckMark:!1,addToForm:!1,inputValueAttribute:null,preselect:[],radio:!1,canDeselect:!1,styles:{},debugMessages:!1},k={"span.imgCheckbox":{"user-select":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none",position:"relative",padding:"0",margin:"2px",display:"inline-block",border:"1px solid transparent","transition-duration":"300ms"},"span.imgCheckbox img":{display:"block",margin:"0",padding:"0","transition-duration":"300ms"},"span.imgCheckbox::before":{display:"block","background-size":"100% 100%",content:"''",color:"white","font-weight":"bold","border-radius":"50%",position:"absolute",margin:"0.5%","z-index":"1","text-align":"center","transition-duration":"300ms"}};class y{static instances=[];static version="2.0.2";element;options;targetIndex=0;imgChkMethods=new Map;constructor(e,t={}){this.init(e,t),y.instances.push(this),1===y.instances.length&&((e,t=!1)=>{!0===t?console.log("Data Type : "+typeof e,"\nValue : "+e):"boolean"!=typeof t?console.log(t):console.log(e)})(`ImgCheckBox is loaded, version: ${y.version}`)}init(e,t){let n=u.getElem(e,"all");n||u.throwError("Element not found"),this.element=Array.isArray(n)?n:n instanceof NodeList?Array.from(n):[n],0===this.element.length&&u.throwError("Element not found"),this.options=u.deepMerge({},b,t),this.options?.onLoad?.(),this.createImgCheckbox(y.instances.length)}createImgCheckbox(e){const t=this.element,n=this.options;let o=null,i={},s=[],r=u.buildStyles("img",p,{transform:"scale(1)",filter:"none","-webkit-filter":"grayscale(0)"},{filter:"grayscale(1)","-webkit-filter":"grayscale(1)"}),l=u.buildStyles("img",p,{transform:"scale(1)"},{transform:"scale(0.9)"}),c=u.buildStyles("::before",p,{transform:"scale(0)"},{transform:"scale(1)"}),a=u.buildStyles("::before",p,{opacity:"0"},{opacity:"1"});n.checkMarkImage&&u.deepMerge(i,{"span.imgCheckbox::before":{"background-image":"url('"+n.checkMarkImage+"')"}});let d=n.checkMarkSize.split(" ");if(u.deepMerge(i,{"span.imgCheckbox::before":{width:d[0],height:d[d.length-1]}}),u.deepMerge(i,{"span.imgCheckbox::before":C[n.checkMarkPosition]}),n.fixedImageSize&&"string"==typeof n.fixedImageSize){let e=n.fixedImageSize.split(" ");u.deepMerge(i,{"span.imgCheckbox img":{width:e[0],height:e[e.length-1]}})}[{doExtension:n.graySelected,style:r},{doExtension:n.scaleSelected,style:l},{doExtension:n.scaleCheckMark,style:c},{doExtension:n.fadeCheckMark,style:a}].forEach((function(e){e.doExtension&&u.deepMerge(i,e.style)})),u.deepMerge(k,u.buildStyles("",p,{"":{"border-color":"#ccc"},img:{},"::before":{}})),i=u.deepMerge({},k,i,n.styles),u.injectStylesheet(i,e.toString());for(let o=0;o<t.length;o++){let i=t[o];if(i.parentNode?.classList.contains("imgCheckbox"+e))continue;if("img"!==i.tagName.toLowerCase())continue;i.ondragstart=()=>!1;let r=document.createElement("span");r.className="imgCheckbox"+e,i.parentNode?.insertBefore(r,i),r.appendChild(i),s.push(r);const l={deselect:()=>{u.changeSelection(r,2,n.addToForm,n.radio,n.canDeselect,s,y.constants),n.onDeselect?.(r)},select:()=>{u.changeSelection(r,1,n.addToForm,n.radio,n.canDeselect,s,y.constants),n.onSelect?.(r)}};if(this.imgChkMethods.set(r,l),r.firstChild&&r.firstChild instanceof HTMLElement&&this.imgChkMethods.set(r.firstChild,l),n.addToForm instanceof Element||!0===n.addToForm){let t=null;t=!0===n.addToForm?i.closest("form"):n.addToForm;let s=n.inputValueAttribute&&i.getAttribute(n.inputValueAttribute)||"";if(t){let n="hEI"+e+"-"+o;const r=i.parentElement;r&&"dataset"in r&&(r.dataset.hiddenElementId=n);let l=i.getAttribute("name")||i.src.match(/\/([^\/]+)\.\w+$/)?.[1]||"",c=document.createElement("input");c.type="checkbox",c.name=l,c.className=n,c.style.display="none",c.value=s,t.appendChild(c)}else n.debugMessages&&console.warn("ImgCheckBox: no form found (looks for form by default)")}}return Array.isArray(this.options.preselect)?this.options.preselect.forEach((e=>{if(e>=0&&e<s.length){const t=this.imgChkMethods.get(s[e])?.select;t?.()}})):!0===this.options.preselect&&s.forEach((e=>{const t=this.imgChkMethods.get(e)?.select;t?.()})),s.forEach((e=>{e.addEventListener("click",(t=>{if(n.enableShiftClick&&!n.radio&&t.shiftKey&&o){let t=s.indexOf(o),i=s.indexOf(e);t>i&&([t,i]=[i,t]);for(let e=t;e<=i;e++){const t=s[e];if(!t.classList.contains(p)){const e=this.imgChkMethods.get(t)?.select;e?.(),n.onClick&&n.onClick(t,!0),n.onChange&&n.onChange(t,!0)}}}else{const t=u.changeSelection(e,0,n.addToForm,n.radio,n.canDeselect,s,y.constants);n.onClick&&n.onClick(e,t),t?n.onSelect?.(e):n.onDeselect?.(e)}o=e})),e.addEventListener("change",(t=>{const o=t;n.onChange&&n.onChange(e,o.detail.isSelected)}))})),this}target(e){if(e>=0&&e<this.element.length)return this.targetIndex=e,this;u.throwError("The given index is out of range.")}state(){const e=u.getElem(this.element[this.targetIndex]).parentNode;return e&&e.classList.contains(p)}select(e){e<0||e>=this.element.length?u.throwError("The given index is out of range."):this.element[e].imgChkSelect?.()}deselect(e){e<0||e>=this.element.length?u.throwError("The given index is out of range."):this.element[e].imgChkDeselect?.()}selectAll(){this.element.forEach((e=>e.imgChkSelect?.()))}deselectAll(){this.element.forEach((e=>e.imgChkDeselect?.()))}destroy(){let e=y.instances.indexOf(this);e<0?u.throwError("ImgCheckBox instance not found"):(u.removeStylesheet(e.toString()),this.element.forEach((t=>{let n=t.parentNode;n&&n.classList.contains("imgCheckbox"+e)&&(n.parentNode?.insertBefore(t,n),n.parentNode?.removeChild(n))})),y.instances.splice(e,1))}getChecked(){return this.element.filter((e=>e.parentElement?.classList.contains(p)))}getUnchecked(){return this.element.filter((e=>!e.parentElement?.classList.contains(p)))}get length(){return this.element.length}static get constants(){return{CHECK_MARK:p,CHK_DESELECT:2,CHK_TOGGLE:0,CHK_SELECT:1}}}return y}));
