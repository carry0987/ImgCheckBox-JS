!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ImgCheckBox=t()}(this,(function(){"use strict";function e(e){throw new Error(e)}var t=Object.freeze({__proto__:null,reportError:function(...e){console.error(...e)},throwError:e});function n(e,t,n){if("string"!=typeof e)return e;let o=document;return null===t&&n?o=n:t&&t instanceof Node&&"querySelector"in t?o=t:n&&n instanceof Node&&"querySelector"in n&&(o=n),"all"===t?o.querySelectorAll(e):o.querySelector(e)}function o(e,t={},n=""){let o=document.createElement(e);for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&("textContent"===e||"innerText"===e?o.textContent=t[e]:o.setAttribute(e,t[e]));return n&&(o.textContent=n),o}var i=Object.freeze({__proto__:null,addClass:function(e,t){return e.classList.add(t),e},createElem:o,getElem:n,hasClass:function(e,t){return e.classList.contains(t)},insertAfter:function(t,n){if("string"==typeof n){let t=o("div");t.innerHTML=n,(n=t.firstChild)||e("The new node (string) provided did not produce a valid DOM element.")}t.parentNode.insertBefore(n,t.nextSibling)},insertBefore:function(t,n){if("string"==typeof n){let t=o("div");t.innerHTML=n,(n=t.firstChild)||e("The new node (string) provided did not produce a valid DOM element.")}t.parentNode.insertBefore(n,t)},removeClass:function(e,t){return e.classList.remove(t),e},toggleClass:function(e,t){return e.classList.toggle(t),e}});let s="utils-style";const r={from:".utils",to:".utils-"};function l(e,...t){if(!t.length)return e;const n=t.shift();if(n)for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t],s=t;"object"!=typeof(o=i)||null===o||Array.isArray(o)?e[s]=i:(e[s]&&"object"==typeof e[s]||(e[s]={}),l(e[s],i))}var o;return l(e,...t)}function c(e){s=e}function a(e,t){r.from=e,r.to=t}function d(e,t=null){t=f(t)?"":t;let n=o("style");n.id=s+t,n.textContent="",document.head.append(n);let i=n.sheet;for(let n in e)e.hasOwnProperty(n)&&g(i,n,h(e[n]),t)}function h(e){let t="";for(let[n,o]of Object.entries(e))n=n.replace(/([A-Z])/g,(e=>`-${e[0].toLowerCase()}`)),t+=`${n}:${o};`;return t}function g(e,t,n,o=null){o=f(o)?"":o;let i=t.replace(r.from,r.to+o);e.insertRule(i+"{"+n+"}",0)}function m(e=null){e=f(e)?"":e;let t=n("#"+s+e);t&&t.parentNode.removeChild(t)}function f(e){return"number"!=typeof e&&(!e||"string"==typeof e&&0===e.length)}class u{static throwError=t.throwError;static deepMerge=l;static setStylesheetId=c;static setReplaceRule=a;static injectStylesheet=d;static removeStylesheet=m;static getElem=i.getElem;static changeSelection=function(e,t,n,o,i,s,r){const{CHECK_MARK:l,CHK_DESELECT:c,CHK_TOGGLE:a,CHK_SELECT:d}=r,h=e.classList.contains(l);o&&t!==c?(s.forEach((t=>t!==e&&t.classList.remove(l))),i?e.classList.toggle(l):e.classList.add(l)):t===c&&e.classList.remove(l)||t===a&&e.classList.toggle(l)||t===d&&e.classList.add(l);const g=e.classList.contains(l);if(h!==g){const t=new CustomEvent("change",{detail:{isSelected:g}});e.dispatchEvent(t)}return n&&u.updateFormValues(o?s:e,l),g};static updateFormValues=function(e,t){(e instanceof Array?e:[e]).forEach((function(e){u.getElem("."+e.dataset.hiddenElementId,"all").forEach((function(n){"input"===n.tagName.toLowerCase()&&(n.checked=!!e.classList.contains(t),n.checked?n.setAttribute("checked","checked"):n.removeAttribute("checked"))}))}))};static buildStyles=function(e,t,n,o){let i={};const s=(e,n,o=!1)=>{let s=e.startsWith("::")?"":" ";e||(s="."+t),i[`span.imgCheckbox${o?"."+t:""}${s}${e}`]=n};if("object"==typeof n&&"object"==typeof o)s(e,n),s(e,o,!0);else for(let[e,t]of Object.entries(n))s(e,t,!!e);return i}}u.setStylesheetId("imgCheckbox-style"),u.setReplaceRule(".imgCheckbox",".imgCheckbox");let C=function(e,t=!1){!0===t?console.log("Data Type : "+typeof e,"\nValue : "+e):"boolean"!=typeof t?console.log(t):console.log(e)};class p{constructor(e,t={}){this.init(e,t),p.instance.push(this),1===p.instance.length&&C(`ImgCheckBox is loaded, version: ${p.version}`)}static CHK_TOGGLE=0;static CHK_SELECT=1;static CHK_DESELECT=2;static CHECK_MARK="imgChked";static CHECKMARK_POSITION={"top-left":{top:"0.5%",left:"0.5%"},top:{top:"0.5%",left:0,right:0,margin:"auto"},"top-right":{top:"0.5%",right:"0.5%"},left:{left:"0.5%",bottom:0,top:0,margin:"auto"},right:{right:"0.5%",bottom:0,top:0,margin:"auto"},"bottom-left":{bottom:"0.5%",left:"0.5%"},bottom:{bottom:"0.5%",left:0,right:0,margin:"auto"},"bottom-right":{bottom:"0.5%",right:"0.5%"},center:{top:"0.5%",bottom:"0.5%",left:"0.5%",right:"0.5%",margin:"auto"}};static defaults={checkMarkImage:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtMzQ2LjM4NCkiPjxwYXRoIGZpbGw9IiMxZWM4MWUiIGZpbGwtb3BhY2l0eT0iLjgiIGQ9Ik0zMiAzNDYuNGEzMiAzMiAwIDAgMC0zMiAzMiAzMiAzMiAwIDAgMCAzMiAzMiAzMiAzMiAwIDAgMCAzMi0zMiAzMiAzMiAwIDAgMC0zMi0zMnptMjEuMyAxMC4zbC0yNC41IDQxTDkuNSAzNzVsMTcuNyA5LjYgMjYtMjh6Ii8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTkuNSAzNzUuMmwxOS4zIDIyLjQgMjQuNS00MS0yNiAyOC4yeiIvPjwvZz48L3N2Zz4=",enableShiftClick:!0,graySelected:!0,scaleSelected:!0,fixedImageSize:!1,checkMark:"imgChked",checkMarkSize:"30px",checkMarkPosition:"top-left",scaleCheckMark:!0,fadeCheckMark:!1,addToForm:!0,preselect:[],radio:!1,canDeselect:!1,styles:{},onLoad:!1,onClick:!1,onSelect:null,onDeselect:null,debugMessages:!1};static defaultStyles={"span.imgCheckbox":{"user-select":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none",position:"relative",padding:"0",margin:"2px",display:"inline-block",border:"1px solid transparent","transition-duration":"300ms"},"span.imgCheckbox img":{display:"block",margin:"0",padding:"0","transition-duration":"300ms"},"span.imgCheckbox::before":{display:"block","background-size":"100% 100%",content:"''",color:"white","font-weight":"bold","border-radius":"50%",position:"absolute",margin:"0.5%","z-index":"1","text-align":"center","transition-duration":"300ms"}};init(e,t){let n=u.getElem(e,"all");n&&0!==n.length||u.throwError("Element not found"),t||u.throwError("Option not found"),p.CHECK_MARK=t.checkMark||p.CHECK_MARK,this.element=n,this.targetElement=e,this.options=u.deepMerge({},p.defaults,t),this.options?.onLoad&&this.options.onLoad(),this.imgCheckboxClass(p.instance.length)}imgCheckboxClass(e){let t,n=this.element,o=this.options,i=[],s={},r=u.buildStyles("img",p.CHECK_MARK,{transform:"scale(1)",filter:"none","-webkit-filter":"grayscale(0)"},{filter:"grayscale(1)","-webkit-filter":"grayscale(1)"}),l=u.buildStyles("img",p.CHECK_MARK,{transform:"scale(1)"},{transform:"scale(0.9)"}),c=u.buildStyles("::before",p.CHECK_MARK,{transform:"scale(0)"},{transform:"scale(1)"}),a=u.buildStyles("::before",p.CHECK_MARK,{opacity:"0"},{opacity:"1"});!1!==o.checkMarkImage&&u.deepMerge(s,{"span.imgCheckbox::before":{"background-image":"url('"+o.checkMarkImage+"')"}});let d=o.checkMarkSize.split(" ");if(u.deepMerge(s,{"span.imgCheckbox::before":{width:d[0],height:d[d.length-1]}}),u.deepMerge(s,{"span.imgCheckbox::before":p.CHECKMARK_POSITION[o.checkMarkPosition]}),o.fixedImageSize){let e=o.fixedImageSize.split(" ");u.deepMerge(s,{"span.imgCheckbox img":{width:e[0],height:e[e.length-1]}})}[{doExtension:o.graySelected,style:r},{doExtension:o.scaleSelected,style:l},{doExtension:o.scaleCheckMark,style:c},{doExtension:o.fadeCheckMark,style:a}].forEach((function(e){e.doExtension&&u.deepMerge(s,e.style)})),u.deepMerge(p.defaultStyles,u.buildStyles("",p.CHECK_MARK,{"":{"border-color":"#ccc"},img:{},"::before":{}})),s=u.deepMerge({},p.defaultStyles,s,o.styles),u.injectStylesheet(s,e);for(let t=0;t<n.length;t++){let s=n[t];if(s.parentNode.classList.contains("imgCheckbox"+e))continue;if("img"!==s.tagName.toLowerCase())continue;if(0===s.offsetWidth&&0===s.offsetHeight)continue;s.ondragstart=()=>!1;let r=document.createElement("span");if(r.className="imgCheckbox"+e,s.parentNode.insertBefore(r,s),r.appendChild(s),i.push(r),r.imgChkDeselect=()=>{u.changeSelection(r,p.CHK_DESELECT,o.addToForm,o.radio,o.canDeselect,i,p.constants),o.onDeselect?.(r)},r.imgChkSelect=()=>{u.changeSelection(r,p.CHK_SELECT,o.addToForm,o.radio,o.canDeselect,i,p.constants),o.onSelect?.(r)},r.firstChild.imgChkDeselect=()=>{u.changeSelection(r,p.CHK_DESELECT,o.addToForm,o.radio,o.canDeselect,i,p.constants),o.onDeselect?.(r)},r.firstChild.imgChkSelect=()=>{u.changeSelection(r,p.CHK_SELECT,o.addToForm,o.radio,o.canDeselect,i,p.constants),o.onSelect?.(r)},o.addToForm instanceof Element||!0===o.addToForm){if(!0===o.addToForm){let e=s.closest("form");o.addToForm=e||!1}if(o.addToForm?.length&&0===o.addToForm.length&&(o.debugMessages&&C("imgCheckbox: no form found (looks for form by default)"),o.addToForm=!1),o.addToForm){let n="hEI"+e+"-"+t;s.parentNode.dataset.hiddenElementId=n;let i=s.getAttribute("name");i=i||s.src.match(/\/(.*)\.[\w]+$/)[1];let r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("name",i),r.className=n,r.style.display="none",r.checked=s.parentNode.classList.contains(p.CHECK_MARK),o.addToForm.appendChild(r)}}}return(!0===o.preselect||o.preselect.length>0)&&i.forEach(((e,t)=>{(!0===o.preselect||o.preselect.indexOf(t)>=0)&&e.classList.add(p.CHECK_MARK)})),i.forEach((e=>{e.addEventListener("click",(n=>{if(o.enableShiftClick&&!o.radio&&n.shiftKey&&t){let n=i.indexOf(t),s=i.indexOf(e);n>s&&([n,s]=[s,n]);for(let e=n;e<=s;e++)i[e].classList.contains(p.CHECK_MARK)||(i[e].imgChkSelect(),o.onClick&&o.onClick(i[e],!0),o.onChange&&o.onChange(i[e],!0))}else{const t=u.changeSelection(e,p.CHK_TOGGLE,o.addToForm,o.radio,o.canDeselect,i,p.constants);o.onClick&&o.onClick(e,t),t?o.onSelect?.(e):o.onDeselect?.(e)}t=e})),e.addEventListener("change",(t=>{o.onChange&&o.onChange(e,t.detail.isSelected)}))})),this}target(e){return e>=0&&e<this.element.length?(this.targetIndex=e,this):u.throwError("The given index is out of range.")}state(){return!!u.getElem(this.element[this.targetIndex]).parentNode.classList.contains(p.CHECK_MARK)}select(e){if(e<0||e>=this.element.length)return u.throwError("The given index is out of range.");this.element[e].imgChkSelect&&this.element[e].imgChkSelect()}deselect(e){if(e<0||e>=this.element.length)return u.throwError("The given index is out of range.");this.element[e].imgChkDeselect&&this.element[e].imgChkDeselect()}selectAll(){for(let e=0;e<this.element.length;e++)this.element[e].imgChkSelect&&this.element[e].imgChkSelect()}deselectAll(){for(let e=0;e<this.element.length;e++)this.element[e].imgChkDeselect&&this.element[e].imgChkDeselect()}destroy(){let e=this.element,t=p.instance.indexOf(this);if(t<0)return u.throwError("ImgCheckBox instance not found");u.removeStylesheet(t);for(let n=0;n<e.length;n++){let o=e[n];if(o.parentNode.classList.contains("imgCheckbox"+t)){let e=o.parentNode;e.parentNode?.insertBefore(o,e),e.parentNode?.removeChild(e)}}p.instance.splice(t,1)}static get constants(){return{CHECK_MARK:p.CHECK_MARK,CHK_DESELECT:p.CHK_DESELECT,CHK_TOGGLE:p.CHK_TOGGLE,CHK_SELECT:p.CHK_SELECT}}static get length(){return this.element.length}}return p.version="1.0.4",p.instance=[],p}));
